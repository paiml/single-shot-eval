# Python-to-Rust Transpilation Task
# Core experiment: Prove SLM can match frontier models at 1/100th cost
#
# Reference: Princeton "AI Agents That Matter" (2024) methodology
# - 5 runs minimum with 95% CI
# - Ground truth via compilation + test execution

task:
  id: python-to-rust-transpile
  description: "Transpile Python functions to idiomatic Rust"
  domain: code-transpile
  version: "1.0.0"

evaluation:
  samples: 50  # From reprorusted corpus
  runs: 5     # Princeton compliance
  timeout_ms: 30000
  metric: accuracy  # pass@1 (compiles + tests pass)

prompts:
  system: |
    You are an expert code transpiler specializing in Python to Rust conversion.
    Convert the given Python code to idiomatic, safe Rust code.

    Requirements:
    - Use proper Rust types (Vec, String, Option, Result)
    - Handle errors with Result/Option, not panics
    - Follow Rust naming conventions (snake_case)
    - Include necessary use statements
    - Return ONLY the Rust code, no explanations

  user_template: |
    Convert this Python function to Rust:

    ```python
    {python_code}
    ```

    Return only valid Rust code that compiles.

ground_truth:
  source: "data/corpus/transpile_corpus.jsonl"
  label_key: "expected"

baselines:
  - id: claude-sonnet
    provider: anthropic
    model: claude-sonnet-4-20250514
    cost_per_1m_tokens: 3.00
  - id: gpt-4o
    provider: openai
    model: gpt-4o
    cost_per_1m_tokens: 5.00
  - id: gemini-pro
    provider: google
    model: gemini-1.5-pro
    cost_per_1m_tokens: 3.50

slm_target:
  model_size_mb: 400  # ~100M params
  target_accuracy: 0.85  # 85% of frontier
  target_cost_reduction: 100x
  quantization: Q8_0
